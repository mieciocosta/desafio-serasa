Perfeito â€” pelas tuas telas dÃ¡ pra ver que vocÃª jÃ¡ estÃ¡ exatamente nas **3 filas**:

* **Entrada**: `sigcn-med-solicitacaorecuperacao-recebimento` (onde vocÃª posta)
* **Retorno**: `sigcn-med-solicitacaorecuperacao-retorno` (onde vocÃª valida o â€œokâ€ do canal digital)
* **Falhas**: `sigcn-med-falhas-solicitacaorecuperacao-envio` (onde cai erro de validaÃ§Ã£o / fallback)

E tambÃ©m aparece o aviso grande: **â€œacesso Ã  rede pÃºblica desabilitadoâ€** e o botÃ£o **â€œAlternar para a Redeâ€**.

Abaixo vai um **passo a passo bem operacional**: onde clicar, que JSON postar e como validar.

---

## 0) Antes de tudo: resolver o â€œAlternar para a Redeâ€

Se vocÃª estiver fora da rede permitida, o Azure Portal **nÃ£o vai deixar** â€œEspiar / Ver / Enviarâ€ mensagem.

1. Na prÃ³pria tela da fila, clique no botÃ£o **â€œAlternar para a Redeâ€** (lado direito).
2. Se abrir a parte de rede (Networking) e vocÃª nÃ£o tiver permissÃ£o, o caminho tÃ­pico Ã©:

   * entrar pela **VPN/rede corporativa** (quando existe), **ou**
   * pedir para liberarem teu **IP** na allowlist do namespace (se o time de infra fizer isso).
3. Volte pra fila e clique **Atualizar**.

> Se depois disso ainda nÃ£o aparecer o corpo/mensagens, Ã© 99% rede/permissÃ£o.

---

## 1) Teste de SUCESSO (entrada â†’ cosmos CRIADO â†’ retorno)

### 1.1 Onde clicar para POSTAR na fila de **recebimento**

Na fila **`sigcn-med-solicitacaorecuperacao-recebimento`**:

1. Clique em **â€œEnviar mensagensâ€** (barra de aÃ§Ãµes no topo).
2. Vai abrir o painel de envio. Normalmente vocÃª vai ver campos tipo:

   * **Corpo da mensagem**
   * (opcional) Content-Type / propriedades
3. Cole o JSON (abaixo) e clique em **Enviar**.

### 1.2 JSON de teste (bem rastreÃ¡vel)

Use este aqui (bem simples e com `teste_miecio` + `IdFimaFim`):

```json
{
  "teste_miecio": "OK_RECUP_001",
  "IdFimaFim": "MIECIO_FIMAFIM_OK_001",
  "origem": "SICONT",
  "idTransacao": "TX_MIECIO_001",
  "valor": 10.5,
  "dataSolicitacao": "2026-01-21T15:00:00Z",
  "motivo": "FRAUDE_GOLPE"
}
```

> Mesmo que o layout real tenha mais campos, esse JSON jÃ¡ serve como â€œsmokeâ€ **se o teu consumidor nÃ£o exigir muitos obrigatÃ³rios**.
> Se ele exigir, vocÃª vai ver cair em **falhas** (e aÃ­ a gente ajusta o payload conforme o erro retornado).

### 1.3 Como VALIDAR que processou

#### A) Validar na fila de **recebimento**

1. Clique em **Modo de Espiada** (drop-down).
2. Clique **â€œEspiar prÃ³ximas mensagensâ€**.

   * Se o worker consumiu rÃ¡pido, vai ficar **Fila (0)**.
3. Clique na aba **â€œMensagens mortasâ€**:

   * Se aparecer aqui, Ã© erro/retry estourado (DLQ).

#### B) Validar na fila de **retorno**

Na fila **`sigcn-med-solicitacaorecuperacao-retorno`**:

1. Clique **â€œEspiar prÃ³ximas mensagensâ€**.
2. Marque a mensagem e clique **â€œBaixe o corpo da mensagem selecionadaâ€** (ou â€œMostrar o corpo da mensagemâ€ se aparecer).
3. O **sucesso do canal digital** costuma vir com algo como:

   * `protocolo`
   * `idRecuperacaoValor` (ou idRecuperacao)

> Se vocÃª postou como SICONT e o fluxo â€œsucesso = Cosmos CRIADOâ€ sem retorno, pode nÃ£o cair nada aqui â€” aÃ­ a validaÃ§Ã£o Ã© no Cosmos.

#### C) Validar no Cosmos DB (status CRIADO)

No Azure Portal:

1. Abra o **Cosmos DB Account** do projeto
2. VÃ¡ em **Data Explorer**
3. Entre no container que guarda os pedidos (o time te passou â€œCosmos DB com status CRIADOâ€; se vocÃª souber o nome eu deixo a query certinha)
4. Rode uma query buscando pelo teu rastreio:

Exemplo de query (SQL do Cosmos) â€” ajuste nome dos campos conforme estiverem lÃ¡:

```sql
SELECT * FROM c
WHERE c.IdFimaFim = "MIECIO_FIMAFIM_OK_001"
   OR c.teste_miecio = "OK_RECUP_001"
   OR c.idTransacao = "TX_MIECIO_001"
```

**O que procurar no documento:**

* `status` = **CRIADO**
* `IdFimaFim` / `idTransacao` batendo
* timestamps de criaÃ§Ã£o/update

---

## 2) Teste de ERRO DE VALIDAÃ‡ÃƒO (entrada â†’ fila de falhas)

### 2.1 Postar um JSON propositalmente invÃ¡lido

Na **`sigcn-med-solicitacaorecuperacao-recebimento`** â†’ **Enviar mensagens**:

```json
{
  "teste_miecio": "ERRO_LAYOUT_001",
  "IdFimaFim": "MIECIO_FIMAFIM_ERRO_001",
  "origem": "SICONT"
}
```

(Ex.: faltando campos de transaÃ§Ã£o, valor, motivo etc.)

### 2.2 Validar na fila de **falhas**

Na **`sigcn-med-falhas-solicitacaorecuperacao-envio`**:

1. Clique **â€œEspiar prÃ³ximas mensagensâ€**
2. Abra o corpo: **â€œBaixe o corpoâ€¦â€** / â€œMostrar o corpoâ€¦â€
3. Valide se vem algo como:

* motivo do erro (campo obrigatÃ³rio ausente, leiaute invÃ¡lido etc.)
* o teu `IdFimaFim`/`teste_miecio` para provar correlaÃ§Ã£o

> Se cair em falhas, vocÃª jÃ¡ prova o critÃ©rio â€œRetornar erro ao sistema de origem / erro controladoâ€.

---

## 3) Teste de DLQ (Mensagens mortas) â€” quando dÃ¡ erro â€œnÃ£o tratÃ¡velâ€

Esse Ã© mais chatinho porque precisa de um erro que **sempre falhe** e gere retry atÃ© estourar.

### Como validar DLQ (sem precisar esperar muito)

1. Na fila **recebimento**, clique na aba **â€œMensagens mortasâ€**
2. Se tiver mensagens, selecione e:

   * **Baixe o corpo da mensagem selecionada**
   * Veja **DeliveryCount**/motivo (Ã s vezes aparece nos headers/propriedades)

> Para forÃ§ar DLQ de verdade, normalmente Ã©:

* mandar mensagem que quebra o consumidor (ex.: JSON malformado, tipo errado crÃ­tico)
* ou simular dependÃªncia fora (endpoint indisponÃ­vel) se o worker nÃ£o tratar com backoff

Se vocÃª me mandar **um exemplo de mensagem que vocÃª viu indo pra DLQ**, eu te digo exatamente qual tipo de payload reproduz isso.

---

## 4) Teste de â€œMudanÃ§a de Statusâ€ (TASK 76172) â€” se vocÃª tambÃ©m posta manual

Se existir uma fila especÃ­fica de **mudanÃ§a de status** (nÃ£o vi o nome nas tuas telas, mas a massa Ã© essa):

### JSON (layout da task)

```json
{
  "teste_miecio": "STATUS_ANALYZED_001",
  "IdFimaFim": "MIECIO_FIMAFIM_OK_001",
  "StatusAnterior": "PROCESSING",
  "StatusAtual": "ANALYZED",
  "DataDoRegistro": "2026-01-21T15:05:00Z"
}
```

**ValidaÃ§Ã£o esperada:**

* algum update no Cosmos (status/etapa)
* e/ou disparo do fluxo de devoluÃ§Ã£o (dependendo do worker encadeado)

---

## 5) O â€œmapaâ€ rÃ¡pido do que cada fila significa (pra nÃ£o se perder)

### `...-recebimento`

âœ… VocÃª posta aqui para iniciar teste
ğŸ“Œ Valida: consumiu? ficou 0? foi DLQ?

### `...-retorno`

âœ… Aqui vocÃª valida a resposta do canal digital
ğŸ“Œ Valida: `protocolo` + `idRecuperacaoValor`

### `...-falhas-...-envio`

âœ… Aqui vocÃª valida erro de validaÃ§Ã£o/contrato
ğŸ“Œ Valida: motivo do erro + correlaÃ§Ã£o com teu `IdFimaFim`

---

## Me diz 2 coisas que eu deixo â€œcirÃºrgicoâ€ (sem vocÃª ter que adivinhar)

1. **Qual container Cosmos** guarda o pedido de recuperaÃ§Ã£o (nome exato).
2. Qual Ã© o **nome exato do campo** que o time usa como chave (Ã© `IdFimaFim` mesmo? ou `idFimAFim` / `endToEndId` / `idTransacao`?).

Com isso eu te devolvo:

* as **queries prontas** do Cosmos (sem tentativa/erro),
* e a massa JSON **no layout real** (com todos obrigatÃ³rios) pra cair em **sucesso garantido** e gerar retorno/protocolo.
